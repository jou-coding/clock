var I=Object.defineProperty;var S=(o,e,s)=>e in o?I(o,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):o[e]=s;var u=(o,e,s)=>S(o,typeof e!="symbol"?e+"":e,s);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const t of n)if(t.type==="childList")for(const r of t.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&i(r)}).observe(document,{childList:!0,subtree:!0});function s(n){const t={};return n.integrity&&(t.integrity=n.integrity),n.referrerPolicy&&(t.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?t.credentials="include":n.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function i(n){if(n.ep)return;n.ep=!0;const t=s(n);fetch(n.href,t)}})();class b{getTime(){const e=new Date;return{hour:e.getHours(),minute:e.getMinutes(),second:e.getSeconds()}}}class y{constructor(e,s,i){u(this,"id");u(this,"time");u(this,"isActive");u(this,"audio");this.id=e,this.time=s,this.isActive=i??!0,this.audio=new Audio("alarm.mp3")}getId(){return this.id}get(){return{hour:this.time.hour,min:this.time.min}}ringAudio(){this.audio.play()}stopAudio(){this.audio.pause(),this.audio.currentTime=0}getIsActive(){return this.isActive}toggleActive(){this.isActive=!this.isActive}equal(e,s,i,n){const t=new Date,r=n?new Date(n):new Date(t.getFullYear(),t.getMonth(),t.getDate(),e.hour,e.min);if(r.getTime()<new Date().getTime())console.log("過去のアラームなので、スキップof明日に再設定");else if(r.getTime()>new Date().getTime()){const c=setInterval(()=>{const m=new Date;console.log("まだ実行中");const g=i.getAlarm(s);m.getTime()>=r.getTime()&&(clearInterval(c),console.log("インターバルを停止しました。"),console.log("プログラムを終了します。"),g!==void 0&&g.getIsActive()===!0&&(this.ringAudio(),setTimeout(()=>{this.stopAudio();const l=new Date(r);l.setDate(l.getDate()+1),this.equal({hour:l.getHours(),min:l.getMinutes()},s,i,l)},1e4)))},1e3)}}}class k{constructor(){u(this,"alarms");this.alarms=new Map}add(e){this.alarms.set(e.getId(),e)}getMap(){return this.alarms}deleteAlarm(e){const s=this.alarms.get(e);console.log(s),s==null||s.stopAudio(),this.alarms.delete(e)}getAlarm(e){if(this.alarms.has(e))return this.alarms.get(e);console.error("戻り値がundefind:",this.alarms.get(e))}}function a(o){return document.getElementById(o)}function A({hour:o,minute:e,second:s}){const i=a("hour"),n=a("min"),t=a("second");i&&n&&t&&(i.textContent=String(o),n.textContent=String(e),t.textContent=String(s))}const h=a("alarmlist");function w(o,e){const s=document.createElement("div");s.classList.add("alarm-card",`${o}`);const i=document.createElement("div");if(i.classList.add("alarm-time"),/^\d$/.test(String(e.min))){const c=`0${e.min}`;i.textContent=`${e.hour}:${c}`}else i.textContent=`${e.hour}:${e.min}`;const n=document.createElement("div");n.classList.add("alarm-actions");const t=document.createElement("input");t.type="checkbox",t.checked=!0;const r=document.createElement("button");r.classList.add("delete-button"),r.type="button",r.textContent="削除",h!==null&&h.append(s),s.append(i),s.append(n),n.append(t),n.append(r)}function M(o){if(localStorage.length>=0){let e="";for(let s=0;s<localStorage.length;s++)if(e=localStorage.key(s),typeof e=="string"){const i=localStorage.getItem(e);if(typeof i=="string"){const n=JSON.parse(i),t=new y(n.id,n.time,n.isActive);w(t.getId(),t.get()),t.equal(t.get(),t.getId(),o),o.add(t)}}}}class D{constructor(){u(this,"time");this.time=0}setTime(e){return setInterval(e,1e3)}clearTime(){clearInterval(this.time)}getTime(){return this.time}}const v=a("btn"),d=a("modalOverlay"),E=a("stop"),L=a("submit"),p=a("alarmlist");function C(){v&&v.addEventListener("click",()=>{d!==null&&d.classList.add("active")})}function O(){E&&E.addEventListener("click",()=>{d!==null&&d.classList.remove("active")})}function x(o){L&&L.addEventListener("click",()=>{const e=a("getHour"),s=a("getMin");if(e instanceof HTMLInputElement&&s instanceof HTMLInputElement){const i=e.value,n=s.value,t=/^([0-9]|1[0-9]|2[0-4])$/,r=/^([0-9]|[1-5][0-9]|60)$/;if(t.test(i)===!0&&r.test(n)===!0){const c={hour:Number(i),min:Number(n)};o(c),d!==null&&d.classList.remove("active")}else{if(a("message")!==null)return;{const l=document.getElementsByClassName("modal")[0],f=document.createElement("div");if(f.id="message",f.textContent="0～24時間、0から60分以外の数字が入力されている。",f.classList.add("error-message"),!l)return;const T=l==null?void 0:l.children[5];l.insertBefore(f,T??null)}}}})}function N(o){p!==null&&p.addEventListener("click",e=>{var i,n,t;if(!(e.target instanceof HTMLElement))return;const s=e.target;if(s.classList.contains("delete-button")){const r=(i=s.parentElement)==null?void 0:i.parentElement;if(r!=null){const c=(t=(n=s.parentElement)==null?void 0:n.parentElement)==null?void 0:t.classList[1];r.remove(),localStorage.removeItem(String(c)),o.deleteAlarm(String(c))}}})}function H(o){p!=null&&p.addEventListener("click",e=>{var n;const i=(n=e.target.parentElement)==null?void 0:n.parentElement;//!=nullとundefindを除外する方法
if(i!=null){const t=i.classList[1],r=o.getAlarm(t);r!==void 0&&(r.toggleActive(),r.getIsActive()===!1&&r.stopAudio());const c=localStorage.getItem(t);if(typeof c=="string"){const m=JSON.parse(c);m.isActive=!m.isActive;const g=JSON.stringify(m);localStorage.setItem(t,g)}}})}function $(){const o=a("clock-btn"),e=a("alarm-btn"),s=a("clock-view"),i=a("alarm-view");o&&(o.addEventListener("click",()=>{s instanceof HTMLElement&&i instanceof HTMLElement&&(s.style.display="block",i.style.display="none")}),e&&e.addEventListener("click",()=>{s instanceof HTMLElement&&i instanceof HTMLElement&&(s.style.display="none",i.style.display="block")}))}function B(o,e){new D().setTime(()=>A(o.getTime())),C(),O(),$(),x(i=>{const n=Math.ceil(Math.random()*1e3),t=new y(String(n),i);w(t.getId(),t.get()),t.equal(t.get(),t.getId(),e),e.add(t),localStorage.setItem(String(n),JSON.stringify(t))}),N(e),H(e)}function V(){const o=new b,e=new k;A(o.getTime()),M(e),B(o,e)}V();
